// demo/linkqueue_demo.cpp
#include "LinkQueue.h"
#include <iostream>
#include <string>

using namespace std;
using namespace WLib;

int main()
{
    cout << "=== LinkQueue 测试 ===" << endl;
    
    try {
        // 创建一个整数链式队列
        LinkQueue<int> intQueue;
        
        cout << "初始队列长度: " << intQueue.length() << endl;
        
        // 测试入队操作
        cout << "\n--- 入队操作 ---" << endl;
        for(int i = 1; i <= 5; i++) {
            intQueue.add(i * 10);
            cout << "入队: " << i * 10 << ", 队列长度: " << intQueue.length() << endl;
        }
        
        // 测试查看队首元素
        cout << "\n--- 查看队首元素 ---" << endl;
        cout << "队首元素: " << intQueue.front() << endl;
        cout << "队列长度: " << intQueue.length() << endl;
        
        // 测试出队操作
        cout << "\n--- 出队操作 ---" << endl;
        while(intQueue.length() > 0) {
            cout << "队首元素: " << intQueue.front() << ", ";
            intQueue.remove();
            cout << "出队, 剩余元素数: " << intQueue.length() << endl;
        }
        
        // 测试队列空情况
        cout << "\n--- 测试队列空情况 ---" << endl;
        try {
            int front = intQueue.front();
            cout << "队首元素: " << front << endl;
        } catch(const Exception& e) {
            cout << "捕获异常: " << e.message() << endl;
        }
        
        try {
            intQueue.remove();
            cout << "出队成功" << endl;
        } catch(const Exception& e) {
            cout << "捕获异常: " << e.message() << endl;
        }
        
        // 测试大量元素
        cout << "\n--- 大量元素测试 ---" << endl;
        LinkQueue<int> largeQueue;
        const int COUNT = 1000;
        cout << "入队 " << COUNT << " 个元素..." << endl;
        for(int i = 1; i <= COUNT; i++) {
            largeQueue.add(i);
        }
        cout << "入队完成，队列长度: " << largeQueue.length() << endl;
        
        // 只测试前5个和后5个元素
        cout << "前5个元素: ";
        for(int i = 0; i < 5; i++) {
            cout << largeQueue.front() << " ";
            largeQueue.remove();
        }
        cout << endl;
        
        // 出队剩余元素
        while(largeQueue.length() > 5) {
            largeQueue.remove();
        }
        
        cout << "后5个元素: ";
        while(largeQueue.length() > 0) {
            cout << largeQueue.front() << " ";
            largeQueue.remove();
        }
        cout << endl;
        cout << "最终队列长度: " << largeQueue.length() << endl;
        
        // 测试清空队列
        cout << "\n--- 测试清空队列 ---" << endl;
        // 重新入队一些元素
        for(int i = 1; i <= 3; i++) {
            intQueue.add(i * 100);
        }
        cout << "入队3个元素后长度: " << intQueue.length() << endl;
        intQueue.clear();
        cout << "清空后长度: " << intQueue.length() << endl;
        
        // 测试字符串类型的链式队列
        cout << "\n--- 字符串链式队列测试 ---" << endl;
        LinkQueue<string> stringQueue;
        stringQueue.add("First");
        stringQueue.add("Second");
        stringQueue.add("Third");
        
        cout << "字符串队列元素(出队顺序):" << endl;
        while(stringQueue.length() > 0) {
            cout << "  " << stringQueue.front() << endl;
            stringQueue.remove();
        }
        
        // 测试生产者-消费者示例
        cout << "\n--- 生产者-消费者示例 ---" << endl;
        LinkQueue<string> taskQueue;
        taskQueue.add("Task1");
        taskQueue.add("Task2");
        taskQueue.add("Task3");
        
        cout << "添加任务到队列..." << endl;
        while(taskQueue.length() > 0) {
            cout << "处理任务: " << taskQueue.front() << endl;
            taskQueue.remove();
        }
        cout << "所有任务处理完成!" << endl;
        
    } catch(const Exception& e) {
        cout << "捕获异常: " << e.message() << " (" << e.location() << ")" << endl;
    } catch(...) {
        cout << "捕获未知异常" << endl;
    }
    
    cout << "\n=== 测试结束 ===" << endl;
    
    return 0;
}